<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data Visualization with WJPr • WJPr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Visualization with WJPr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WJPr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/dataviz.html">Data Visualization with WJPr</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ctoruno/WJPr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="dataviz_files/kePrint-0.0.1/kePrint.js"></script><link href="dataviz_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data Visualization with WJPr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ctoruno/WJPr/blob/main/vignettes/articles/dataviz.Rmd" class="external-link"><code>vignettes/articles/dataviz.Rmd</code></a></small>
      <div class="d-none name"><code>dataviz.Rmd</code></div>
    </div>

    
    
<p>This vignette describes the use of the data visualization functions
included in the <code>WJPr</code> package on a fictional
<code>GPP</code> dataset that is included as part of the package. Until
version 1.0.0, there are eight data viz functions included in the base
package:</p>
<ol style="list-style-type: decimal">
<li>Bars (Horizontal/Vertical/Stacked)</li>
<li>Diverging Horizontal Bars</li>
<li>Lines</li>
<li>Slopes</li>
<li>Dots</li>
<li>Dumbbells</li>
<li>Radar</li>
<li>Edgebars</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org" class="external-link">haven</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ctoruno/WJPr" class="external-link">WJPr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Always load the WJP fonts if not passing a custom theme to function</span></span>
<span><span class="fu">wjp_fonts</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loading data</span></span>
<span><span class="va">gpp_data</span> <span class="op">&lt;-</span> <span class="fu">WJPr</span><span class="fu">::</span><span class="va"><a href="../reference/gpp.html">gpp</a></span></span></code></pre></div>
<div class="section level2">
<h2 id="bar-charts">Bar Charts<a class="anchor" aria-label="anchor" href="#bar-charts"></a>
</h2>
<div class="section level3">
<h3 id="preparing-the-data">Preparing the data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h3>
<p>We will begin by plotting a simple vertical chart. When it comes to
GPP data, we usually plot percentages of response between groups of
respondents. For this task, we will try to plot the percentage of
respondents in each country in our GPP dataset that have a lot or some
trust in Institution A. This is given by the percentage of people who
answered 1 o 2 for question Q1A. Therefore, we proceed to wrangle our
data to reflect this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data4bars</span> <span class="op">&lt;-</span> <span class="va">gpp_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span>, <span class="va">q1a</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    q1a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="va">q1a</span><span class="op">)</span>,</span>
<span>    trust <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">q1a</span> <span class="op">&lt;=</span> <span class="fl">2</span>  <span class="op">~</span> <span class="fl">1</span>,</span>
<span>      <span class="va">q1a</span> <span class="op">&lt;=</span> <span class="fl">4</span>  <span class="op">~</span> <span class="fl">0</span>,</span>
<span>      <span class="va">q1a</span> <span class="op">==</span> <span class="fl">99</span> <span class="op">~</span> <span class="cn">NA_real_</span></span>
<span>    <span class="op">)</span>,</span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    trust   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">trust</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"keep"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    trust <span class="op">=</span> <span class="va">trust</span><span class="op">*</span><span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="st">"2022"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="va">data4bars</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:left;">
year
</th>
<th style="text-align:right;">
trust
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Atlantis
</td>
<td style="text-align:left;">
2022
</td>
<td style="text-align:right;">
49.09091
</td>
</tr>
<tr>
<td style="text-align:left;">
Narnia
</td>
<td style="text-align:left;">
2022
</td>
<td style="text-align:right;">
45.65217
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverland
</td>
<td style="text-align:left;">
2022
</td>
<td style="text-align:right;">
63.63636
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="simple-vertical-chart">Simple vertical chart<a class="anchor" aria-label="anchor" href="#simple-vertical-chart"></a>
</h3>
<p>Once that we have our data ready, we begin by plotting a very simple
vertical chart with our GPP data. We just need to specify the names of
the columns that contain the values to be plotted in the Y-Axis
(<code>target</code>) and the variable containing the categories to be
displayed in the X-Axis (<code>grouping</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wjp_bars.html">wjp_bars</a></span><span class="op">(</span></span>
<span>    <span class="va">data4bars</span>,              </span>
<span>    target    <span class="op">=</span> <span class="st">"trust"</span>,        </span>
<span>    grouping  <span class="op">=</span> <span class="st">"country"</span>    </span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="controlling-color">Controlling color<a class="anchor" aria-label="anchor" href="#controlling-color"></a>
</h3>
<p>We can specify the colors to be used using the <code>colors</code>
and the <code>cvec</code> parameters. The <code>colors</code> parameter
contain the name of the column that will distinguish the different
colors, and then, the <code>cvec</code> parameter will pass a named
vector linking specific values to specific colors. In the following
example, we want all the bars to have a cool gray color, therefore, we
use the column “year” as the <code>color</code> parameter and we pass a
named vector in which we specify that values associated to year “2002”
will have a color code equal to “#8789C0”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wjp_bars.html">wjp_bars</a></span><span class="op">(</span></span>
<span>    <span class="va">data4bars</span>,              </span>
<span>    target    <span class="op">=</span> <span class="st">"trust"</span>,        </span>
<span>    grouping  <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>    colors    <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>    cvec      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2022"</span> <span class="op">=</span> <span class="st">"#8789C0"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
<p>If we would prefer to have a different color per country, we need to
create a new column given that we are already using that same column as
the grouping var. In the following example, we first create a new column
called “color_variable” containing the same values as the columns
“country”</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data4bars</span> <span class="op">&lt;-</span> <span class="va">data4bars</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    color_variable <span class="op">=</span> <span class="va">country</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wjp_bars.html">wjp_bars</a></span><span class="op">(</span></span>
<span>    <span class="va">data4bars</span>,              </span>
<span>    target    <span class="op">=</span> <span class="st">"trust"</span>,        </span>
<span>    grouping  <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>    colors    <span class="op">=</span> <span class="st">"color_variable"</span>,</span>
<span>    cvec      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Atlantis"</span>  <span class="op">=</span> <span class="st">"#2E4057"</span>,</span>
<span>                  <span class="st">"Narnia"</span>    <span class="op">=</span> <span class="st">"#083D77"</span>,</span>
<span>                  <span class="st">"Neverland"</span> <span class="op">=</span> <span class="st">"#F4D35E"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="adding-value-labels">Adding value labels<a class="anchor" aria-label="anchor" href="#adding-value-labels"></a>
</h3>
<p>If we want to add value labels to our chart, we can then make use of
our <code>labels</code> and <code>lab_pos</code> parameters. The first
one contains the name of the column that contains the specific labels to
be displayed. Given that the <code>target</code> parameter might have a
lot of decimals, we usually create a string label rounding the values
plotted in the Y-Axis. Once you have the specific value labels, you
might also need to specify where specifically you would like the labels
to be displayed. In the following example, we create two columns:
“value_label” and “label_position”, we will place the labels 5
percentage points above the top limit of the bars:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data4bars</span> <span class="op">&lt;-</span> <span class="va">data4bars</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    value_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">trust</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>        nsmall <span class="op">=</span> <span class="fl">0</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"%"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    label_position <span class="op">=</span> <span class="va">trust</span> <span class="op">+</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wjp_bars.html">wjp_bars</a></span><span class="op">(</span></span>
<span>    <span class="va">data4bars</span>,              </span>
<span>    target    <span class="op">=</span> <span class="st">"trust"</span>,        </span>
<span>    grouping  <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>    labels    <span class="op">=</span> <span class="st">"value_label"</span>,</span>
<span>    lab_pos   <span class="op">=</span> <span class="st">"label_position"</span>,</span>
<span>    colors    <span class="op">=</span> <span class="st">"color_variable"</span>,</span>
<span>    cvec      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Atlantis"</span>  <span class="op">=</span> <span class="st">"#2E4057"</span>,</span>
<span>                  <span class="st">"Narnia"</span>    <span class="op">=</span> <span class="st">"#083D77"</span>,</span>
<span>                  <span class="st">"Neverland"</span> <span class="op">=</span> <span class="st">"#F4D35E"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="switch-to-horizontal-bars">Switch to horizontal bars<a class="anchor" aria-label="anchor" href="#switch-to-horizontal-bars"></a>
</h3>
<p>By default, the plotted bars are vertical. However, making a
horizontal bars plot is as easy as setting the <code>direction</code>
parameter to “horizontal”.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wjp_bars.html">wjp_bars</a></span><span class="op">(</span></span>
<span>    <span class="va">data4bars</span>,              </span>
<span>    target    <span class="op">=</span> <span class="st">"trust"</span>,        </span>
<span>    grouping  <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>    labels    <span class="op">=</span> <span class="st">"value_label"</span>,</span>
<span>    lab_pos   <span class="op">=</span> <span class="st">"label_position"</span>,</span>
<span>    colors    <span class="op">=</span> <span class="st">"color_variable"</span>,</span>
<span>    cvec      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Atlantis"</span>  <span class="op">=</span> <span class="st">"#2E4057"</span>,</span>
<span>                  <span class="st">"Narnia"</span>    <span class="op">=</span> <span class="st">"#083D77"</span>,</span>
<span>                  <span class="st">"Neverland"</span> <span class="op">=</span> <span class="st">"#F4D35E"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"horizontal"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
</div>
</div>
<div class="section level2">
<h2 id="stacked-bars">Stacked Bars<a class="anchor" aria-label="anchor" href="#stacked-bars"></a>
</h2>
<p>You can also use the <code><a href="../reference/wjp_bars.html">wjp_bars()</a></code> function to plot stacked
bars. Let’s assume that, instead of plotting the percentage of people
who stated that had “A lot” or “Some” trust in Institution A, we prefer
to plot the percentage of people that selected every possible answer in
each country. First, we need to modify our data to reflect this changes
as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data4bars</span> <span class="op">&lt;-</span> <span class="va">gpp_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">q1a</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    q1a  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">q1a</span> <span class="op">==</span> <span class="fl">1</span>  <span class="op">~</span> <span class="st">"A lot"</span>,</span>
<span>      <span class="va">q1a</span> <span class="op">==</span> <span class="fl">2</span>  <span class="op">~</span> <span class="st">"Some"</span>,</span>
<span>      <span class="va">q1a</span> <span class="op">==</span> <span class="fl">3</span>  <span class="op">~</span> <span class="st">"Little"</span>,</span>
<span>      <span class="va">q1a</span> <span class="op">==</span> <span class="fl">4</span>  <span class="op">~</span> <span class="st">"None"</span>,</span>
<span>      <span class="va">q1a</span> <span class="op">==</span> <span class="fl">99</span> <span class="op">~</span> <span class="st">"No answer"</span>,</span>
<span>    <span class="op">)</span>,</span>
<span>    q1a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      <span class="va">q1a</span>, </span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A lot"</span>, <span class="st">"Some"</span>, <span class="st">"Little"</span>, <span class="st">"None"</span>, <span class="st">"No answer"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">q1a</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">country</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">q1a</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    total       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    percentage  <span class="op">=</span> <span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="va">total</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,</span>
<span>    value_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">percentage</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        nsmall <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"%"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    value_label <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">percentage</span> <span class="op">&gt;=</span> <span class="fl">5</span>, <span class="va">value_label</span>, <span class="cn">NA_character_</span><span class="op">)</span>,</span>
<span>    label_position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">percentage</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="va">percentage</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">country</span>, <span class="va">q1a</span>, <span class="va">percentage</span>, <span class="va">value_label</span>, <span class="va">label_position</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="va">data4bars</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:left;">
q1a
</th>
<th style="text-align:right;">
percentage
</th>
<th style="text-align:left;">
value_label
</th>
<th style="text-align:right;">
label_position
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Atlantis
</td>
<td style="text-align:left;">
No answer
</td>
<td style="text-align:right;">
3.508772
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1.7543860
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlantis
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:right;">
14.035088
</td>
<td style="text-align:left;">
14.0%
</td>
<td style="text-align:right;">
10.5263158
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlantis
</td>
<td style="text-align:left;">
Little
</td>
<td style="text-align:right;">
35.087719
</td>
<td style="text-align:left;">
35.1%
</td>
<td style="text-align:right;">
35.0877193
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlantis
</td>
<td style="text-align:left;">
Some
</td>
<td style="text-align:right;">
28.070175
</td>
<td style="text-align:left;">
28.1%
</td>
<td style="text-align:right;">
66.6666667
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlantis
</td>
<td style="text-align:left;">
A lot
</td>
<td style="text-align:right;">
19.298246
</td>
<td style="text-align:left;">
19.3%
</td>
<td style="text-align:right;">
90.3508772
</td>
</tr>
<tr>
<td style="text-align:left;">
Narnia
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:right;">
19.565217
</td>
<td style="text-align:left;">
19.6%
</td>
<td style="text-align:right;">
9.7826087
</td>
</tr>
<tr>
<td style="text-align:left;">
Narnia
</td>
<td style="text-align:left;">
Little
</td>
<td style="text-align:right;">
34.782609
</td>
<td style="text-align:left;">
34.8%
</td>
<td style="text-align:right;">
36.9565217
</td>
</tr>
<tr>
<td style="text-align:left;">
Narnia
</td>
<td style="text-align:left;">
Some
</td>
<td style="text-align:right;">
28.260870
</td>
<td style="text-align:left;">
28.3%
</td>
<td style="text-align:right;">
68.4782609
</td>
</tr>
<tr>
<td style="text-align:left;">
Narnia
</td>
<td style="text-align:left;">
A lot
</td>
<td style="text-align:right;">
17.391304
</td>
<td style="text-align:left;">
17.4%
</td>
<td style="text-align:right;">
91.3043478
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverland
</td>
<td style="text-align:left;">
No answer
</td>
<td style="text-align:right;">
1.785714
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
0.8928571
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverland
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:right;">
12.500000
</td>
<td style="text-align:left;">
12.5%
</td>
<td style="text-align:right;">
8.0357143
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverland
</td>
<td style="text-align:left;">
Little
</td>
<td style="text-align:right;">
23.214286
</td>
<td style="text-align:left;">
23.2%
</td>
<td style="text-align:right;">
25.8928571
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverland
</td>
<td style="text-align:left;">
Some
</td>
<td style="text-align:right;">
42.857143
</td>
<td style="text-align:left;">
42.9%
</td>
<td style="text-align:right;">
58.9285714
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverland
</td>
<td style="text-align:left;">
A lot
</td>
<td style="text-align:right;">
19.642857
</td>
<td style="text-align:left;">
19.6%
</td>
<td style="text-align:right;">
90.1785714
</td>
</tr>
</tbody>
</table>
<p>Pay attention on how we transformed our “q1a” column into a factor
variable and we defined the specific levels (order) of answers. By
specifying the factor levels, we are taking control on how each answer
will be plotted. If we don’t specify the factor levels, the answers will
be plotted in alphabetical order, which is not what we want given that
our variable of interest is a ordered categorical variable.</p>
<p>Once that we have modified our data to fit the new design of our bar
chart, we proceed to use the <code><a href="../reference/wjp_bars.html">wjp_bars()</a></code> function as showed
above but this time, we set the <code>stacked</code> parameter to
TRUE:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stacked_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wjp_bars.html">wjp_bars</a></span><span class="op">(</span></span>
<span>    <span class="va">data4bars</span>,              </span>
<span>    target    <span class="op">=</span> <span class="st">"percentage"</span>,        </span>
<span>    grouping  <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>    labels    <span class="op">=</span> <span class="st">"value_label"</span>,</span>
<span>    lab_pos   <span class="op">=</span> <span class="st">"label_position"</span>,</span>
<span>    colors    <span class="op">=</span> <span class="st">"q1a"</span>,</span>
<span>    cvec      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A lot"</span>     <span class="op">=</span> <span class="st">"#32382E"</span>,</span>
<span>                  <span class="st">"Some"</span>      <span class="op">=</span> <span class="st">"#899878"</span>,</span>
<span>                  <span class="st">"Little"</span>    <span class="op">=</span> <span class="st">"#E4E6C3"</span>,</span>
<span>                  <span class="st">"None"</span>      <span class="op">=</span> <span class="st">"#BF4342"</span>,</span>
<span>                  <span class="st">"No answer"</span> <span class="op">=</span> <span class="st">"#858585"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    stacked   <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">stacked_bar</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-10-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="diverging-bars-charts">Diverging Bars Charts<a class="anchor" aria-label="anchor" href="#diverging-bars-charts"></a>
</h2>
<p>Diverging bars are a specific type of bar chart. However, they use
the negative part of the cartesian plane to plot additional information.
Let’s go back to our prior example where we were displaying the levels
of trust that people in our sample had in Institution A. We could use
diverging bars to plot the percentage of people who answered “A lot” and
“Some” on one side, and the percentage of people who answered “Little”
and “None” on the other. For this, we need to wrangle our data a little
bit different:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data4divbars</span> <span class="op">&lt;-</span> <span class="va">gpp_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">q1a</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    q1a  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">q1a</span> <span class="op">&lt;=</span> <span class="fl">2</span>  <span class="op">~</span> <span class="st">"Trust"</span>,</span>
<span>      <span class="va">q1a</span> <span class="op">&lt;=</span> <span class="fl">4</span>  <span class="op">~</span> <span class="st">"No Trust"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">q1a</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">q1a</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    total       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    percentage  <span class="op">=</span> <span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="va">total</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,</span>
<span>    value_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">percentage</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        nsmall <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"%"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    value_label    <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">percentage</span> <span class="op">&gt;=</span> <span class="fl">5</span>, </span>
<span>                             <span class="va">value_label</span>, </span>
<span>                             <span class="cn">NA_character_</span><span class="op">)</span>,</span>
<span>    direction      <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">q1a</span> <span class="op">==</span> <span class="st">"Trust"</span>, </span>
<span>                             <span class="st">"positive"</span>, </span>
<span>                             <span class="st">"negative"</span><span class="op">)</span>,</span>
<span>    percentage     <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">direction</span> <span class="op">==</span> <span class="st">"negative"</span>, </span>
<span>                             <span class="va">percentage</span><span class="op">*</span><span class="op">-</span><span class="fl">1</span>, </span>
<span>                             <span class="va">percentage</span><span class="op">)</span>,</span>
<span>    label_position <span class="op">=</span> <span class="op">(</span><span class="va">percentage</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">country</span>, <span class="va">q1a</span>, <span class="va">percentage</span>, <span class="va">value_label</span>, <span class="va">label_position</span>, <span class="va">direction</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="va">data4divbars</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:left;">
q1a
</th>
<th style="text-align:right;">
percentage
</th>
<th style="text-align:left;">
value_label
</th>
<th style="text-align:right;">
label_position
</th>
<th style="text-align:left;">
direction
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Atlantis
</td>
<td style="text-align:left;">
No Trust
</td>
<td style="text-align:right;">
-50.90909
</td>
<td style="text-align:left;">
50.9%
</td>
<td style="text-align:right;">
-25.45455
</td>
<td style="text-align:left;">
negative
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlantis
</td>
<td style="text-align:left;">
Trust
</td>
<td style="text-align:right;">
49.09091
</td>
<td style="text-align:left;">
49.1%
</td>
<td style="text-align:right;">
24.54545
</td>
<td style="text-align:left;">
positive
</td>
</tr>
<tr>
<td style="text-align:left;">
Narnia
</td>
<td style="text-align:left;">
No Trust
</td>
<td style="text-align:right;">
-54.34783
</td>
<td style="text-align:left;">
54.3%
</td>
<td style="text-align:right;">
-27.17391
</td>
<td style="text-align:left;">
negative
</td>
</tr>
<tr>
<td style="text-align:left;">
Narnia
</td>
<td style="text-align:left;">
Trust
</td>
<td style="text-align:right;">
45.65217
</td>
<td style="text-align:left;">
45.7%
</td>
<td style="text-align:right;">
22.82609
</td>
<td style="text-align:left;">
positive
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverland
</td>
<td style="text-align:left;">
No Trust
</td>
<td style="text-align:right;">
-36.36364
</td>
<td style="text-align:left;">
36.4%
</td>
<td style="text-align:right;">
-18.18182
</td>
<td style="text-align:left;">
negative
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverland
</td>
<td style="text-align:left;">
Trust
</td>
<td style="text-align:right;">
63.63636
</td>
<td style="text-align:left;">
63.6%
</td>
<td style="text-align:right;">
31.81818
</td>
<td style="text-align:left;">
positive
</td>
</tr>
</tbody>
</table>
<p>Please pay attention on how we create a variable called “direction”
to distinguish the direction in which these values will be plotted.
Values associated with a “negative” direction are turned into negative
numbers.</p>
<p>Once that we have the data we proceed use the
<code><a href="../reference/wjp_divbars.html">wjp_divbars()</a></code> function. Some parameters are used the same
way:</p>
<ul>
<li>
<code>target</code> contains the column name that has the values to
be plotted in the bars.</li>
<li>
<code>grouping</code> contains the column name that has the
categorical groupings.</li>
<li>
<code>cvec</code> contains a named vector linking values to specific
color codes.</li>
<li>
<code>labels</code> contains the column name that has the value
labels to be displayed, if any.</li>
</ul>
<p>Besides these familiar parameters, <code><a href="../reference/wjp_divbars.html">wjp_divbars()</a></code> has two
unique ones that are required for this function to work. First, we need
to set a <code>diverging</code> parameter that will contain the column
name used to distinguish the direction of the values, as well as the
<code>negative</code> parameter, which contains the exact value that
distinguishes the negative values from the positive values within the
<code>diverging</code> variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wjp_divbars.html">wjp_divbars</a></span><span class="op">(</span></span>
<span>    <span class="va">data4divbars</span>,             </span>
<span>    target      <span class="op">=</span> <span class="st">"percentage"</span>,       </span>
<span>    grouping    <span class="op">=</span> <span class="st">"country"</span>,         </span>
<span>    diverging   <span class="op">=</span> <span class="st">"q1a"</span>,     </span>
<span>    negative    <span class="op">=</span> <span class="st">"negative"</span>,   </span>
<span>    cvec        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trust"</span>     <span class="op">=</span> <span class="st">"#4F518C"</span>,</span>
<span>                    <span class="st">"No Trust"</span>  <span class="op">=</span> <span class="st">"#2C2A4A"</span><span class="op">)</span>,</span>
<span>    labels      <span class="op">=</span> <span class="st">"value_label"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-12-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="line-charts">Line Charts<a class="anchor" aria-label="anchor" href="#line-charts"></a>
</h2>
<p>Line charts are an excellent choice to display the evolution of
values over time. You can use the <code><a href="../reference/wjp_lines.html">wjp_lines()</a></code> function to
draw a line chart. Let’s assume that we now want to focus on the
evolution over time of the percentage of people who has “a lot” or
“some” trust in Institution A in Atlantis. First, we need to wrangle the
data to fit our new design:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data4lines</span> <span class="op">&lt;-</span> <span class="va">gpp_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">country</span> <span class="op">==</span> <span class="st">"Atlantis"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">q1a</span>, <span class="va">q1b</span>, <span class="va">q1c</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      <span class="op">!</span><span class="va">year</span>,</span>
<span>      \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      <span class="op">!</span><span class="va">year</span>,</span>
<span>      <span class="op">~</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">.x</span> <span class="op">&lt;=</span> <span class="fl">2</span>  <span class="op">~</span> <span class="fl">1</span>,</span>
<span>        <span class="va">.x</span> <span class="op">&lt;=</span> <span class="fl">4</span>  <span class="op">~</span> <span class="fl">0</span>,</span>
<span>        <span class="va">.x</span> <span class="op">==</span> <span class="fl">99</span> <span class="op">~</span> <span class="cn">NA_real_</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"keep"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">*</span><span class="fl">100</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="va">year</span>,</span>
<span>    names_to  <span class="op">=</span> <span class="st">"variable"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"percentage"</span> </span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    institution <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">variable</span> <span class="op">==</span> <span class="st">"q1a"</span> <span class="op">~</span> <span class="st">"Institution A"</span>,</span>
<span>      <span class="va">variable</span> <span class="op">==</span> <span class="st">"q1b"</span> <span class="op">~</span> <span class="st">"Institution B"</span>,</span>
<span>      <span class="va">variable</span> <span class="op">==</span> <span class="st">"q1c"</span> <span class="op">~</span> <span class="st">"Institution C"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    value_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">percentage</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>        nsmall <span class="op">=</span> <span class="fl">0</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"%"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="va">data4lines</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
percentage
</th>
<th style="text-align:left;">
institution
</th>
<th style="text-align:left;">
value_label
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:left;">
q1a
</td>
<td style="text-align:right;">
62.39316
</td>
<td style="text-align:left;">
Institution A
</td>
<td style="text-align:left;">
62%
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:left;">
q1b
</td>
<td style="text-align:right;">
43.85965
</td>
<td style="text-align:left;">
Institution B
</td>
<td style="text-align:left;">
44%
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:left;">
q1c
</td>
<td style="text-align:right;">
40.00000
</td>
<td style="text-align:left;">
Institution C
</td>
<td style="text-align:left;">
40%
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
q1a
</td>
<td style="text-align:right;">
63.51351
</td>
<td style="text-align:left;">
Institution A
</td>
<td style="text-align:left;">
64%
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
q1b
</td>
<td style="text-align:right;">
42.46575
</td>
<td style="text-align:left;">
Institution B
</td>
<td style="text-align:left;">
42%
</td>
</tr>
<tr>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
q1c
</td>
<td style="text-align:right;">
44.44444
</td>
<td style="text-align:left;">
Institution C
</td>
<td style="text-align:left;">
44%
</td>
</tr>
<tr>
<td style="text-align:left;">
2022
</td>
<td style="text-align:left;">
q1a
</td>
<td style="text-align:right;">
49.09091
</td>
<td style="text-align:left;">
Institution A
</td>
<td style="text-align:left;">
49%
</td>
</tr>
<tr>
<td style="text-align:left;">
2022
</td>
<td style="text-align:left;">
q1b
</td>
<td style="text-align:right;">
32.14286
</td>
<td style="text-align:left;">
Institution B
</td>
<td style="text-align:left;">
32%
</td>
</tr>
<tr>
<td style="text-align:left;">
2022
</td>
<td style="text-align:left;">
q1c
</td>
<td style="text-align:right;">
35.71429
</td>
<td style="text-align:left;">
Institution C
</td>
<td style="text-align:left;">
36%
</td>
</tr>
</tbody>
</table>
<p>Be aware that I’m also leaving trust in Institution B and Institution
C and pivoting the data frame to a long format. However, we will start
by plotting only the percentage of people who trust in Institution A
over time. For this, we proceed to use the <code><a href="../reference/wjp_lines.html">wjp_lines()</a></code>
function. Some parameters are used the same way:</p>
<ul>
<li>
<code>target</code> contains the column name that has the values to
be plotted in the bars.</li>
<li>
<code>grouping</code> contains the column name that has the
categorical groupings. In most line charts, this parameter refers to the
years.</li>
<li>
<code>colors</code> contains the column name that will distinguish
the different colors in the line chart.</li>
<li>
<code>cvec</code> contains a named vector linking values to specific
color codes.</li>
<li>
<code>labels</code> contains the column name that has the value
labels to be displayed, if any.</li>
</ul>
<p>Besides these parameters, the <code><a href="../reference/wjp_lines.html">wjp_lines()</a></code> function also
requires to set a <code>ngroups</code> parameter. The way we are setting
this parameter depends on the number of groups. If we are just plotting
a single line just like in the example bellow, we input
<code>ngroups = 1</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wjp_lines.html">wjp_lines</a></span><span class="op">(</span></span>
<span>    <span class="va">data4lines</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">institution</span> <span class="op">==</span> <span class="st">"Institution A"</span><span class="op">)</span>,                    </span>
<span>    target         <span class="op">=</span> <span class="st">"percentage"</span>,             </span>
<span>    grouping       <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>    ngroups        <span class="op">=</span> <span class="fl">1</span>,                 </span>
<span>    colors         <span class="op">=</span> <span class="st">"institution"</span>,</span>
<span>    cvec           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Institution A"</span> <span class="op">=</span> <span class="st">"#08605F"</span><span class="op">)</span>,</span>
<span>    labels         <span class="op">=</span> <span class="st">"value_label"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-14-1.png" width="480"></p>
<p>Iif we are plotting multiple lines, we need to specify the full
column that contains the groups as in the example bellow. Please also
notice how we are setting <code>repel = TRUE</code> so the value labels
do not overlap between each other. However, you need to have the
<code>ggrepel</code> package loaded in memory.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/wjp_lines.html">wjp_lines</a></span><span class="op">(</span></span>
<span>    <span class="va">data4lines</span>,                    </span>
<span>    target         <span class="op">=</span> <span class="st">"percentage"</span>,             </span>
<span>    grouping       <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>    ngroups        <span class="op">=</span> <span class="va">data4lines</span><span class="op">$</span><span class="va">institution</span>,                 </span>
<span>    colors         <span class="op">=</span> <span class="st">"institution"</span>,</span>
<span>    cvec           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Institution A"</span> <span class="op">=</span> <span class="st">"#08605F"</span>,</span>
<span>                       <span class="st">"Institution B"</span> <span class="op">=</span> <span class="st">"#9E6240"</span>,</span>
<span>                       <span class="st">"Institution C"</span> <span class="op">=</span> <span class="st">"#2E0E02"</span><span class="op">)</span>,</span>
<span>    labels         <span class="op">=</span> <span class="st">"value_label"</span>,</span>
<span>    repel          <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-15-1.png" width="480"></p>
<div class="section level3">
<h3 id="controlling-opacities">Controlling opacities<a class="anchor" aria-label="anchor" href="#controlling-opacities"></a>
</h3>
<p>The <code><a href="../reference/wjp_lines.html">wjp_lines()</a></code> function has a special feature in which
you can add a special highlight to certain lines by assigning different
levels of opacity to different lines. Let’s say that we want to
highlight the line representing the trust levels in Institution A. We
start by setting <code>transparency = TRUE</code> and we pass a named
vector with the opacity levels that we want to assign to different lines
to the <code>transparencies</code> parameter. Please note that the named
vector needs to be based using the same values that were used for the
color vector.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wjp_lines.html">wjp_lines</a></span><span class="op">(</span></span>
<span>    <span class="va">data4lines</span>,                    </span>
<span>    target         <span class="op">=</span> <span class="st">"percentage"</span>,             </span>
<span>    grouping       <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>    ngroups        <span class="op">=</span> <span class="va">data4lines</span><span class="op">$</span><span class="va">institution</span>,                 </span>
<span>    colors         <span class="op">=</span> <span class="st">"institution"</span>,</span>
<span>    cvec           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Institution A"</span> <span class="op">=</span> <span class="st">"#08605F"</span>,</span>
<span>                       <span class="st">"Institution B"</span> <span class="op">=</span> <span class="st">"#9E6240"</span>,</span>
<span>                       <span class="st">"Institution C"</span> <span class="op">=</span> <span class="st">"#2E0E02"</span><span class="op">)</span>,</span>
<span>    labels         <span class="op">=</span> <span class="st">"value_label"</span>,</span>
<span>    repel          <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    transparency   <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    transparencies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Institution A"</span> <span class="op">=</span> <span class="fl">1.00</span>,</span>
<span>                       <span class="st">"Institution B"</span> <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                       <span class="st">"Institution C"</span> <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-16-1.png" width="480"></p>
</div>
</div>
<div class="section level2">
<h2 id="controlling-the-order-of-the-bars">Controlling the order of the bars<a class="anchor" aria-label="anchor" href="#controlling-the-order-of-the-bars"></a>
</h2>
<p>Sometimes, we might want to control the order in which we show some
elements in our charts. Some of the plotting functions in our WJPr
package include the a <code>custom_order</code> and an
<code>order</code> parameter. Let’s say that we want to further
customize the diverging bars that we showed above and present the bars
following in a specific order: Neverland (1), Atlantis (2), and Narnia
(3). For this, we begin by setting the <code>custom_order</code> to TRUE
and adding a new column to our data that has the specific order of the
elements:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data4divbars</span> <span class="op">&lt;-</span> <span class="va">data4divbars</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    order_no <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">country</span> <span class="op">==</span> <span class="st">"Neverland"</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>      <span class="va">country</span> <span class="op">==</span> <span class="st">"Atlantis"</span>  <span class="op">~</span> <span class="fl">2</span>,</span>
<span>      <span class="va">country</span> <span class="op">==</span> <span class="st">"Narnia"</span>    <span class="op">~</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wjp_divbars.html">wjp_divbars</a></span><span class="op">(</span></span>
<span>    <span class="va">data4divbars</span>,             </span>
<span>    target       <span class="op">=</span> <span class="st">"percentage"</span>,       </span>
<span>    grouping     <span class="op">=</span> <span class="st">"country"</span>,         </span>
<span>    diverging    <span class="op">=</span> <span class="st">"q1a"</span>,     </span>
<span>    negative     <span class="op">=</span> <span class="st">"negative"</span>,   </span>
<span>    cvec         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trust"</span>     <span class="op">=</span> <span class="st">"#4F518C"</span>,</span>
<span>                     <span class="st">"No Trust"</span>  <span class="op">=</span> <span class="st">"#2C2A4A"</span><span class="op">)</span>,</span>
<span>    labels       <span class="op">=</span> <span class="st">"value_label"</span>,</span>
<span>    custom_order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    order        <span class="op">=</span> <span class="st">"order_no"</span> </span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-17-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="adding-more-customizations">Adding more customizations<a class="anchor" aria-label="anchor" href="#adding-more-customizations"></a>
</h2>
<p>All the plotting functions from the WJPr package return a ggplot
object. This means that, with a further knowledge of ggplot, the user
can further customize the plot returned by the plotting function. For
example, let’s say that we want to further customize our stacked bars
from before and completely remove the panel grid and add some title and
subtitle to it. We can do it by using the <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs()</a></code> and
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code> functions from the ggplot2 package as shown
bellow:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stacked_bar</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title    <span class="op">=</span> <span class="st">"Trust in Institution A"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Percentage of people who has a lot, some, little, or no trust in Institution A"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x         <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>    plot.subtitle       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="dataviz_files/figure-html/unnamed-chunk-18-1.png" width="480"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carlos A. Toruno Paniagua.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
